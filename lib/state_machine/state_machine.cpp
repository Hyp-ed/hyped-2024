#include "state_machine.hpp"

#include <iostream>

namespace hyped::state_machine {

StateMachine::StateMachine(const TransitionTable &transition_table) 
  : current_state_{State::kIdle},
  transition_to_state_{transition_table}
{
}

State StateMachine::stringToState(const std::string &state_name)
{
  return string_to_state_.at(state_name);
}

std::string StateMachine::stateToString(const State &state)
{
  return state_to_string_.at(state);
}

State StateMachine::getCurrentState()
{
  return current_state_;
}

core::Result StateMachine::handleTransition(const State &state)
{
  const auto next_state = transition_to_state_.find({current_state_, state});
  if (next_state != transition_to_state_.end()) {
    current_state_ = next_state->second;
    return core::Result::kSuccess;
  }
  return core::Result::kFailure;
}

}  // namespace hyped::state_machine